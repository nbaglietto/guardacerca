<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>GuardaCerca - Mockup</title>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <style>
    /* Estilos para centrar el tel√©fono y que sea completamente visible */
    body {
      background: #2c3e50;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      font-family: "Segoe UI", Arial, sans-serif;
      padding: 10px;
      box-sizing: border-box;
      overflow: hidden;
    }

    .telefono {
      width: 340px;
      height: 700px;
      background: #111;
      border-radius: 35px;
      padding: 8px;
      box-shadow: 0 0 30px rgba(0,0,0,0.7);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      position: relative;
      border: 6px solid #222;
      transform: scale(0.95);
    }

    .pantalla {
      background: #fff;
      border-radius: 25px;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      position: relative;
    }

    /* usuario arriba derecha */
    .usuario {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 1005;
      background: rgba(255,255,255,0.95);
      padding: 4px 8px;
      border-radius: 18px;
      display: flex;
      gap: 8px;
      align-items: center;
      box-shadow: 0 1px 4px rgba(0,0,0,0.15);
      font-size: 12px;
    }
    .usuario img { 
      width: 24px; 
      height: 24px; 
      border-radius: 50%; 
      object-fit: cover; 
    }

    /* mapa - AHORA M√ÅS GRANDE (65% en lugar de 55%) */
    #map {
      width: 100%;
      height: 65%;
      z-index: 1;
    }

    .buscador {
      position: absolute;
      top: 12px;
      left: 12px;
      z-index: 1006;
      background: rgba(255,255,255,0.95);
      padding: 6px 10px;
      border-radius: 10px;
      display: flex;
      gap: 6px;
      align-items: center;
      box-shadow: 0 1px 4px rgba(0,0,0,0.2);
    }
    .buscador input {
      border: none;
      outline: none;
      padding: 6px;
      border-radius: 6px;
      width: 150px;
      font-size: 12px;
    }
    .buscador button {
      background: #2196f3;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 6px 8px;
      cursor: pointer;
      font-size: 12px;
    }

    /* listado - AHORA M√ÅS PEQUE√ëO (35% en lugar de 45%) */
    .listado {
      flex: 0 0 35%;
      overflow-y: auto;
      padding: 8px;
      background: #f8f8f8;
      padding-bottom: 45px;
    }

    /* NUEVO DISE√ëO DE ITEMS */
    .item {
      display: flex;
      align-items: flex-start;
      background: white;
      border-radius: 8px;
      padding: 8px;
      margin-bottom: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      gap: 10px;
      cursor: pointer;
    }

    .item img {
      width: 60px;
      height: 60px;
      border-radius: 6px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .info {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .linea-superior {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }

    .barrio {
      color: #333;
      font-size: 14px;
      font-weight: bold;
    }

    .ubicacion {
      color: #666;
      font-size: 11px;
      font-style: italic;
      text-align: right;
      max-width: 100px;
    }

    .precio {
      font-size: 13px;
      color: #2196f3;
      font-weight: bold;
    }

    .detalles {
      font-size: 11px;
      color: #666;
      line-height: 1.3;
    }

    .acciones {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .acciones button {
      font-size: 10px;
      padding: 5px 8px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      color: white;
      min-width: 60px;
    }
    .acciones .consultar { background: #2196f3; }
    .acciones .reservar  { background: #4caf50; }

    /* barra inferior Android (est√©tica) */
    .botones-android {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 40px;
      background: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 40px;
      border-bottom-left-radius: 25px;
      border-bottom-right-radius: 25px;
      z-index: 1003;
    }
    .boton-android { 
      width: 20px; 
      height: 20px; 
      opacity: 0.8; 
    }
    .boton-android.atras::before { 
      content: "<"; 
      font-size: 20px; 
      color: white; 
      display: block; 
      text-align: center; 
    }
    .boton-android.home { 
      border: 2px solid white; 
      border-radius: 4px; 
    }
    .boton-android.menu { 
      width: 16px; 
      height: 2px; 
      background: white; 
      position: relative; 
    }
    .boton-android.menu::before, 
    .boton-android.menu::after { 
      content: ""; 
      width: 16px; 
      height: 2px; 
      background: white; 
      position: absolute; 
      left: 0; 
    }
    .boton-android.menu::before { top: -5px; } 
    .boton-android.menu::after{ top: 5px; }

    /* modal / detalle / reservar */
    .modal-bg {
      position: fixed; 
      inset: 0; 
      display: none; 
      align-items: center; 
      justify-content: center;
      background: rgba(0,0,0,0.45); 
      z-index: 2000;
    }
    .modal {
      width: 300px; 
      max-height: 80%; 
      background: white; 
      border-radius: 12px; 
      overflow: auto; 
      box-shadow: 0 8px 30px rgba(0,0,0,0.3);
    }
    .modal .header { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      padding: 8px 10px; 
      border-bottom: 1px solid #eee; 
    }
    .modal .body { 
      padding: 10px; 
      font-size: 12px; 
      color: #333; 
    }
    .modal img { 
      width: 100%; 
      height: 140px; 
      object-fit: cover; 
      border-radius: 6px; 
    }

    .info-row { 
      display: flex; 
      justify-content: space-between; 
      gap: 6px; 
      margin-top: 6px; 
      font-size: 12px; 
    }
    .stars { color: gold; }

    .form input, .form select, .form textarea { 
      width: 100%; 
      padding: 6px; 
      margin-top: 6px; 
      border-radius: 4px; 
      border: 1px solid #ddd; 
      box-sizing: border-box; 
      font-size: 12px;
    }
    .form button { 
      margin-top: 8px; 
      padding: 8px; 
      border-radius: 6px; 
      border: none; 
      background: #2196f3;
      color: white; 
      cursor: pointer; 
      width: 100%; 
      font-size: 12px;
    }

    /* Scrollbar personalizado para el listado */
    .listado::-webkit-scrollbar {
      width: 4px;
    }
    .listado::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 2px;
    }
    .listado::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 2px;
    }
    .listado::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
  </style>
</head>
<body>
  <div class="telefono">
    <div class="pantalla">
      <div class="usuario" title="Usuario logueado">
        <img src="https://i.pravatar.cc/40?u=nahuel" alt="Nahuel">
        <span>Nahuel</span>
      </div>

      <div id="map"></div>

      <div class="buscador">
        <input id="search" type="text" placeholder="Buscar barrio..." />
        <button id="btnSearch">üîç</button>
      </div>

      <div class="listado" id="listado">
        <!-- items generados por JS -->
      </div>

      <div class="botones-android">
        <div class="boton-android atras"></div>
        <div class="boton-android home"></div>
        <div class="boton-android menu"></div>
      </div>
    </div>
  </div>

  <!-- modal -->
  <div class="modal-bg" id="modalBg" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <div class="header">
        <strong id="modalTitle">Detalle</strong>
        <button id="modalClose" aria-label="Cerrar">‚úï</button>
      </div>
      <div class="body" id="modalBody"></div>
    </div>
  </div>

  <script>
    // Lista de im√°genes locales en la carpeta ../img/
    const imagenesLocales = [
      'img/1.jpg',
      'img/2.jfif',
      'img/3.jpg',
      'img/4.jfif',
      'img/5.jfif',
      'img/6.jpg'
    ];

    // Funci√≥n para obtener imagen aleatoria
    function getImagenAleatoria() {
      const indiceAleatorio = Math.floor(Math.random() * imagenesLocales.length);
      return imagenesLocales[indiceAleatorio];
    }

    // Datos: M√∫ltiples ubicaciones por barrio con im√°genes locales
    const places = [
      // Palermo - 3 ubicaciones
      { barrio:"Palermo", ubicacion:"Palermo Soho", lat:-34.5883, lng:-58.4258, m2:10, seguro:true, dispo:"Inmediata", cal:5 },
      { barrio:"Palermo", ubicacion:"Palermo Hollywood", lat:-34.5803, lng:-58.4308, m2:8, seguro:false, dispo:"Con reserva", cal:4 },
      { barrio:"Palermo", ubicacion:"Las Ca√±itas", lat:-34.5753, lng:-58.4358, m2:12, seguro:true, dispo:"Inmediata", cal:5 },
      
      // Belgrano - 3 ubicaciones
      { barrio:"Belgrano", ubicacion:"Belgrano R", lat:-34.5638, lng:-58.4566, m2:9, seguro:true, dispo:"Inmediata", cal:4 },
      { barrio:"Belgrano", ubicacion:"Barrio Chino", lat:-34.5688, lng:-58.4466, m2:7, seguro:false, dispo:"No", cal:3 },
      { barrio:"Belgrano", ubicacion:"Belgrano C", lat:-34.5588, lng:-58.4516, m2:11, seguro:true, dispo:"Con reserva", cal:5 },
      
      // Caballito - 2 ubicaciones
      { barrio:"Caballito", ubicacion:"Caballito Norte", lat:-34.6099, lng:-58.4436, m2:8, seguro:false, dispo:"Inmediata", cal:4 },
      { barrio:"Caballito", ubicacion:"Parque Centenario", lat:-34.6059, lng:-58.4336, m2:10, seguro:true, dispo:"Con reserva", cal:5 },
      
      // San Telmo - 2 ubicaciones
      { barrio:"San Telmo", ubicacion:"Plaza Dorrego", lat:-34.6153, lng:-58.3715, m2:6, seguro:false, dispo:"No", cal:3 },
      { barrio:"San Telmo", ubicacion:"Monserrat", lat:-34.6103, lng:-58.3765, m2:9, seguro:true, dispo:"Inmediata", cal:4 },
      
      // Recoleta - 3 ubicaciones
      { barrio:"Recoleta", ubicacion:"Recoleta Centro", lat:-34.5896, lng:-58.3940, m2:12, seguro:true, dispo:"Inmediata", cal:5 },
      { barrio:"Recoleta", ubicacion:"Barrio Norte", lat:-34.5846, lng:-58.3990, m2:8, seguro:false, dispo:"Con reserva", cal:4 },
      { barrio:"Recoleta", ubicacion:"Cementerio", lat:-34.5946, lng:-58.3890, m2:10, seguro:true, dispo:"Inmediata", cal:5 },
      
      // Flores - 2 ubicaciones
      { barrio:"Flores", ubicacion:"Flores Centro", lat:-34.6317, lng:-58.4622, m2:7, seguro:true, dispo:"Inmediata", cal:5 },
      { barrio:"Flores", ubicacion:"Flores Sur", lat:-34.6367, lng:-58.4572, m2:9, seguro:false, dispo:"No", cal:3 },
      
      // Villa Crespo - 2 ubicaciones
      { barrio:"Villa Crespo", ubicacion:"Villa Crespo Norte", lat:-34.5991, lng:-58.4352, m2:5, seguro:false, dispo:"Inmediata", cal:4 },
      { barrio:"Villa Crespo", ubicacion:"Villa Crespo Sur", lat:-34.6041, lng:-58.4402, m2:8, seguro:true, dispo:"Con reserva", cal:5 },
      
      // Almagro - 2 ubicaciones
      { barrio:"Almagro", ubicacion:"Almagro Este", lat:-34.6072, lng:-58.4161, m2:11, seguro:true, dispo:"Con reserva", cal:3 },
      { barrio:"Almagro", ubicacion:"Almagro Oeste", lat:-34.6122, lng:-58.4211, m2:7, seguro:false, dispo:"Inmediata", cal:4 },
      
      // Chacarita - 2 ubicaciones
      { barrio:"Chacarita", ubicacion:"Chacarita Norte", lat:-34.5999, lng:-58.4494, m2:14, seguro:true, dispo:"Inmediata", cal:5 },
      { barrio:"Chacarita", ubicacion:"Chacarita Sur", lat:-34.6049, lng:-58.4544, m2:10, seguro:false, dispo:"Con reserva", cal:4 },
      
      // Barracas - 2 ubicaciones
      { barrio:"Barracas", ubicacion:"Barracas Norte", lat:-34.6281, lng:-58.3747, m2:10, seguro:false, dispo:"Inmediata", cal:4 },
      { barrio:"Barracas", ubicacion:"Barracas Sur", lat:-34.6331, lng:-58.3797, m2:8, seguro:true, dispo:"No", cal:3 }
    ];

    // Asignar im√°genes aleatorias a cada ubicaci√≥n
    places.forEach(place => {
      place.img = getImagenAleatoria();
    });

    // Inicializar mapa Leaflet (OpenStreetMap)
    const map = L.map('map').setView([-34.6037, -58.3816], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors',
      maxZoom: 19
    }).addTo(map);

    // Icono por defecto de Leaflet (s√≠mbolo de ubicaci√≥n est√°ndar)
    const defaultIcon = L.icon({
      iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',
      iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',
      shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });

    const markers = {};

    // render markers and listado
    const listado = document.getElementById('listado');

    function price(m2){ return (m2 * 25).toFixed(2); }

    places.forEach((p, idx) => {
      // marcador con el icono est√°ndar de ubicaci√≥n
      const m = L.marker([p.lat, p.lng], { icon: defaultIcon }).addTo(map);
      m.bindPopup(`
        <div style="min-width: 200px;">
          <strong>${p.barrio}</strong><br>
          <em>${p.ubicacion}</em><br>
          ${p.m2} m¬≤ ‚Äî USD ${price(p.m2)}/mes<br>
          <small>${p.seguro ? '‚úÖ Seguro' : '‚ùå Sin seguro'} ‚Ä¢ ${p.dispo}</small>
        </div>
      `);
      
      m.on('click', () => {
        // destacar tarjeta: scroll y sombra temporal
        const card = document.querySelector(`.item[data-idx="${idx}"]`);
        if(card){ 
          card.scrollIntoView({behavior:'smooth', block:'center'}); 
          card.style.boxShadow='0 6px 18px rgba(33,150,243,0.18)'; 
          setTimeout(()=>card.style.boxShadow='',700); 
        }
      });
      markers[idx] = m;

      // NUEVO DISE√ëO DE ITEMS
      const imgSrc = p.img;
      const item = document.createElement('div');
      item.className = 'item';
      item.dataset.idx = idx;
      item.innerHTML = `
        <img src="${imgSrc}" alt="${p.barrio}" onerror="this.src='${getImagenAleatoria()}'">
        <div class="info">
          <div class="linea-superior">
            <span class="barrio">${p.barrio}</span>
            <span class="ubicacion">${p.ubicacion}</span>
          </div>
          <div class="precio">USD ${price(p.m2)}/mes</div>
          <div class="detalles">${p.m2} m¬≤ ‚Ä¢ ${p.seguro ? 'Requiere seguro' : 'Sin seguro'} ‚Ä¢ ${p.dispo}</div>
        </div>
        <div class="acciones">
          <button class="consultar">Consultar</button>
          <button class="reservar">Reservar</button>
        </div>
      `;
      // click en tarjeta (flyTo)
      item.addEventListener('click', (e) => {
        // si fue clic en bot√≥n, no ejecutar flyTo (botones tienen su propio handler)
        if(e.target.tagName === 'BUTTON') return;
        map.flyTo([p.lat, p.lng], 15, { duration: 1.0 });
        markers[idx].openPopup();
      });

      // consultar
      item.querySelector('.consultar').addEventListener('click', (ev) => {
        ev.stopPropagation();
        openConsulta(p, idx);
      });

      // reservar
      item.querySelector('.reservar').addEventListener('click', (ev) => {
        ev.stopPropagation();
        openReservar(p, idx);
      });

      listado.appendChild(item);
    });

    // buscar barrio
    document.getElementById('btnSearch').addEventListener('click', () => {
      const q = document.getElementById('search').value.trim().toLowerCase();
      if(!q) {
        // mostrar todo y centrar
        document.querySelectorAll('.item').forEach(i=> i.style.display='flex');
        map.setView([-34.6037, -58.3816], 12);
        return;
      }
      document.querySelectorAll('.item').forEach(item => {
        const idx = item.dataset.idx;
        const p = places[idx];
        if(p.barrio.toLowerCase().includes(q) || p.ubicacion.toLowerCase().includes(q)) {
          item.style.display = 'flex';
          // centrar en el primer match
          map.flyTo([p.lat, p.lng], 14, { duration: 0.8 });
          markers[idx].openPopup();
        } else {
          item.style.display = 'none';
        }
      });
    });

    // Modal handlers
    const modalBg = document.getElementById('modalBg');
    const modalTitle = document.getElementById('modalTitle');
    const modalBody = document.getElementById('modalBody');
    const modalClose = document.getElementById('modalClose');

    modalClose.addEventListener('click', closeModal);
    modalBg.addEventListener('click', (e) => { if(e.target === modalBg) closeModal(); });
    document.addEventListener('keydown', (e)=> { if(e.key === 'Escape') closeModal(); });

    function closeModal(){
      modalBg.style.display = 'none';
      modalBg.setAttribute('aria-hidden','true');
      modalTitle.textContent = '';
      modalBody.innerHTML = '';
    }

    // Abrir consulta (detalle) - CON CAMPO DE TEXTO PARA CONSULTA
    function openConsulta(p, idx){
      modalTitle.textContent = `${p.barrio} ‚Äî ${p.ubicacion}`;
      const img = p.img;
      modalBody.innerHTML = `
        <img src="${img}" alt="${p.barrio}" onerror="this.src='${getImagenAleatoria()}'">
        <div class="info-row">
          <div><strong>Superficie</strong><div>${p.m2} m¬≤</div></div>
          <div><strong>Precio</strong><div>USD ${price(p.m2)}/mes</div></div>
        </div>
        <div class="info-row">
          <div><strong>Seguro</strong><div>${p.seguro ? 'S√≠' : 'No'}</div></div>
          <div><strong>Disponibilidad</strong><div>${p.dispo}</div></div>
        </div>
        <div class="info-row">
          <div><strong>Calificaci√≥n</strong><div class="stars">${'‚òÖ'.repeat(p.cal)}${'‚òÜ'.repeat(5-p.cal)}</div></div>
          <div><strong>Ubicaci√≥n</strong><div>${p.ubicacion}</div></div>
        </div>
        <p style="margin-top:8px;color:#555;font-size:12px"><em>Usuario logueado: Nahuel</em></p>
        
        <form id="consultaForm" class="form">
          <label style="font-size:11px;color:#555;margin-top:8px">Tu consulta:</label>
          <textarea id="consultaText" rows="3" placeholder="Escribe tu consulta sobre este espacio..." required></textarea>
          <button type="submit">Enviar consulta</button>
        </form>
        
        <div style="display:flex;gap:8px;margin-top:10px">
          <button id="modalFav" class="heart" style="flex:0;padding:6px;border:none;background:none;font-size:16px;cursor:pointer">‚ô°</button>
        </div>
      `;
      modalBg.style.display = 'flex';
      modalBg.setAttribute('aria-hidden','false');

      document.getElementById('modalFav').addEventListener('click', function(){
        this.classList.toggle('active');
        this.textContent = this.classList.contains('active') ? '‚ù§Ô∏è' : '‚ô°';
      });
      
      document.getElementById('consultaForm').addEventListener('submit', (ev) => {
        ev.preventDefault();
        const consultaText = document.getElementById('consultaText').value.trim();
        if(!consultaText) {
          alert('Por favor, escribe tu consulta antes de enviar.');
          return;
        }
        alert('Consulta enviada correctamente.');
        closeModal();
      });
    }

    // Abrir reservar (form) - CON BOT√ìN CELESTE Y SIN TEXTO (SIMULADO)
    function openReservar(p, idx){
      modalTitle.textContent = `Reservar ‚Äî ${p.barrio} - ${p.ubicacion}`;
      const img = p.img;
      modalBody.innerHTML = `
        <img src="${img}" alt="${p.barrio}" onerror="this.src='${getImagenAleatoria()}'">
        <p style="margin:8px 0 0;color:#333;font-size:12px">Contrato m√≠nimo: 1 mes. Dep√≥sito: 1 mes. Precio: <strong>USD ${price(p.m2)}/mes</strong>.</p>
        <form id="resForm" class="form">
          <label style="font-size:11px;color:#555;margin-top:8px">Nombre</label>
          <input type="text" id="rname" value="Nahuel" required>
          <label style="font-size:11px;color:#555;margin-top:6px">Email</label>
          <input type="email" id="remail" value="nahuel@example.com" required>
          <label style="font-size:11px;color:#555;margin-top:6px">Fecha inicio</label>
          <input type="date" id="rdate" required>
          <label style="font-size:11px;color:#555;margin-top:6px">Duraci√≥n (meses)</label>
          <select id="rmonths" required>
            <option value="1">1</option><option value="3">3</option><option value="6">6</option>
          </select>
          <button type="submit">Confirmar reserva</button>
        </form>
      `;
      modalBg.style.display = 'flex';
      modalBg.setAttribute('aria-hidden','false');

      document.getElementById('resForm').addEventListener('submit', (ev)=>{
        ev.preventDefault();
        const name = document.getElementById('rname').value.trim();
        const email = document.getElementById('remail').value.trim();
        const date = document.getElementById('rdate').value;
        const months = document.getElementById('rmonths').value;
        if(!name||!email||!date||!months) return alert('Complet√° todos los campos.');
        const reservas = JSON.parse(localStorage.getItem('reservas')||'[]');
        reservas.push({ barrio:p.barrio, ubicacion:p.ubicacion, name, email, date, months, precio:price(p.m2), created: new Date().toISOString() });
        localStorage.setItem('reservas', JSON.stringify(reservas));
        alert('‚úÖ Reserva registrada.');
        closeModal();
      });
    }

    // ajustar bounds para mostrar todos los marcadores
    function fitAll(){
      const group = L.featureGroup(Object.values(markers));
      if(Object.keys(markers).length>0) map.fitBounds(group.getBounds().pad(0.2));
    }
    // esperar un momento y ajustar para que el mapa muestre todo
    setTimeout(()=> fitAll(), 250);

    // guardar usuario simulado
    localStorage.setItem('usuario', JSON.stringify({ nombre:'Nahuel', email:'nahuel@example.com' }));
  </script>
</body>
</html>





